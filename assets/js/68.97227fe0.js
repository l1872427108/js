(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{465:function(t,s,a){"use strict";a.r(s);var n=a(56),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"实现-setinterval"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现-setinterval"}},[t._v("#")]),t._v(" 实现 setInterval")]),t._v(" "),a("p",[t._v("我们执行一个函数想要隔特定的时间再去执行，我们可以使用 setTimeout、setInterval 来实现。")]),t._v(" "),a("p",[t._v("浏览器返回值是一个数字，Node 环境返回的是一个对象。")]),t._v(" "),a("h3",{attrs:{id:"二者差异"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二者差异"}},[t._v("#")]),t._v(" 二者差异")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("第一个使用 setTimeout\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n第二个使用 setTimeout\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInterval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("使用 setInterval， 下一次执行会等待一秒，但是 一秒内会执行 func 函数，如果func函数执行时间超过延迟的时间，引擎会等待 func 执行完成，即使它的时间要超过延迟时间，如果每次都会超过，那么就会连续执行，没有停顿。")]),t._v(" "),a("p",[t._v("但是 setTimeout, 下一次执行会先执行完 func 函数，再去延迟执行。所以，它延迟的时间更精准。")]),t._v(" "),a("h3",{attrs:{id:"为什么要释放定时器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么要释放定时器"}},[t._v("#")]),t._v(" 为什么要释放定时器")]),t._v(" "),a("p",[t._v("定时器延迟阶段，将会为其创建一个内部引用，并保存在调度程序中。如果说它引用了外部变量，那么变量将不会被收回，所以我们不用定时器之后，要将它收回。")]),t._v(" "),a("h3",{attrs:{id:"零延迟"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#零延迟"}},[t._v("#")]),t._v(" 零延迟")]),t._v(" "),a("p",[t._v("定时器在设置为 0 秒之后，在浏览器并不会真的是 0 秒延迟，HTML5 中所讲：经过 5 重嵌套定时器之后，时间间隔将被设置为至少 4 毫秒。所以每次延迟的数字将会越来越大。")]),t._v(" "),a("ol",[a("li",[t._v("CPU 过载。")]),t._v(" "),a("li",[t._v("浏览器页签处于后台模式。")]),t._v(" "),a("li",[t._v("笔记本电脑用的是电池供电。(电池供电会以降低性能为代价提升续航).")])]),t._v(" "),a("p",[t._v("所以延迟将会在 300ms ～ 1000ms 之间。")]),t._v(" "),a("h3",{attrs:{id:"模拟实现一个-setinterval"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模拟实现一个-setinterval"}},[t._v("#")]),t._v(" 模拟实现一个 setInterval")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),a("p",[t._v("setTimeout 给了我们更加灵活的控制后续时间。")])])}),[],!1,null,null,null);s.default=e.exports}}]);